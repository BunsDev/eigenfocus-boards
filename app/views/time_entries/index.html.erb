
<%= turbo_frame_tag 'time_entry_form' do %>

<% end %>

<%= turbo_frame_tag 'time_entries' do %>
<div class="flex flex-col sm:flex-row justify-stretch items-stretch sm:justify-end gap-4 mb-6">
  <%= link_to new_time_entry_path(reference_date: @reference_date), class: "btn-primary btn-xl", data: { turbo_frame: 'time_entry_form' } do %>
    <i class="fa-solid fa-circle-plus mr-2"></i>
    <%= "#{t('actions.new')} #{TimeEntry.model_name.human.downcase}" %>
  <% end %>
</div>

<div class="mb-8 mt-4 flex gap-4 justify-stretch overflow-x-auto items-stretch">
  <% @calendar_dates.each do |date| %>
    <%
      wrap_tag = (date == @reference_date) ? :div : :a
      wrap_options = if (date == @reference_date)
        {
          class: "border border-primary-600 text-primary-600"
        }
      else
        {
          class: "bg-body-contrast border-background-300 cursor-pointer text-readable-content-400 hover:border-primary-700 hover:text-primary-700 hover:shadow-lg hover:bg-background-100",
          href: time_entries_path(reference_date: date)
        }
      end
      wrap_options[:data] = {
        'reference-date': date.strftime("%Y-%m-%d"),
        'turbo-action': 'advance'
      }
      wrap_options[:class] += " transition-colors grow rounded-md flex flex-col gap-2 font-normal text-center p-4 border shadow-xs"

    %>

    <%= content_tag wrap_tag, wrap_options do %>
      <span class="text-sm"><%= l(date, format: :short_weekday_name )%>, <%= l(date, format: :short )%></span>
      <span class="text-md turbo-stream-logged-time-text"><%= convert_minutes_to_human_readable_hour(@total_logged_time_per_day[date] || 0) %></span>
    <% end %>
  <% end %>
</div>


<div class="flex flex-col gap-4" id="time-entries-tbody">
  <% if @time_entries.count.zero? %>
    <div id="empty-row" class="card">
      <p class='text-center text-readable-content-500'>
        <%= t(".zero_records", date: l(@reference_date, format: :long )) %>
      </p>
      <p class="mt-3 text-center mb-4">
        <%= link_to new_time_entry_path(reference_date: @reference_date), class: "btn-primary py-4 inline-block", data: { turbo_frame: 'time_entry_form' } do %>
          <i class="fa-solid fa-circle-plus mr-1"></i>
          <%= t('.click_here_to_create') %>
        <% end %>
      </p>
    </tr>
  <% else %>
    <%= render partial: 'time_entry', collection: @time_entries, as: :time_entry %>
  <% end %>
</div>
<% end %>
